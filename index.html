<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Установка Arch Linux</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans">
    <link rel="icon" type="image/x-icon" href="https://archlinux.org/static/favicon.29302f683ff8.ico">
    <style>
      body {
        font-family: 'Noto Sans', sans-serif;
        background: #b6cdf526;
        overflow-y: scroll;
      }

      summary:focus {
        outline: none;
      }

      .in2 {
        margin-left: 30px;
      }

      .code {
        margin-top: 15px;
        background-color: #ebf1f5;
        border: 1px solid #bbccdd;
        overflow: auto;
        word-break: break-all;
        padding-left: 10px;
        height: auto;
      }

      .code_part {
        margin-top: 0;
        border-top-style: dashed;
        background-color: #ebf1f5;
        border: 1px solid #bbccdd;
        overflow: auto;
        word-break: break-all;
        padding-left: 10px;
        height: auto;
      }

      .code_end {
        margin-top: 15px;
        margin-bottom: 20px;
        background-color: #ebf1f5;
        border: 1px solid #bbccdd;
        overflow: auto;
        word-break: break-all;
        padding-left: 10px;
        height: auto;
      }

      .arch_logo {
        width: 60%;
        height: auto;
      }

      .commentary {
        font-size: 14px;
      }

      .commentary_end {
        font-size: 14px;
      }

      a {
        color: blue;
      }

      a:visited {
        color: blue;
      }
    </style>
  </head>
  <body>
    <h1>Установка Arch Linux</h1>
    <a href="https://archlinux.org" target="_blank"><img class="arch_logo" src="https://i.imgur.com/ykWSVKK.png"></a>
    <details>
      <summary><b>1. Загрузка</b></summary>
      <div class="in2">
        <p class="commentary">Скачать дистрибутив с официального сайта: <a href="https://archlinux.org/download" target="_blank">https://archlinux.org/download</a></p>
      </div>
    </details>
    <details>
      <summary><b>2. Перед установкой</b></summary>
      <div class="in2">
        <h3>Установка раскладки клавиатуры</h3>
        <p class="commentary">Выбрать русскую раскладку</p>
        <div class="code">
          <pre># loadkeys ru</pre>
        </div>
        <p class="commentary">Выбрать консольный шрифт, поддерживающий кириллицу</p>
        <div class="code">
          <pre># setfont cyr-sun16</pre>
        </div>
        <h3>Соединение с интернетом</h3>
        <p class="commentary">Подключить проводной интернет</p>
        <div class="code">
          <pre># dhcpcd</pre>
        </div>
        <p class="commentary">Или Wi-Fi</p>
        <p class="commentary">Проверить сетевой интерфейс</p>
        <div class="code">
          <pre># ip link</pre>
        </div>
        <p class="commentary">Подключиться к Wi-Fi</p>
        <div class="code">
          <pre># iwctl</pre>
        </div>
        <div class="code">
          <pre>[iwd]# station <i>device</i> connect <i>SSID</i></pre>
        </div>
        <p class="commentary"><i>device</i> - сетевой интерфейс</p>
        <p class="commentary"><i>SSID</i> - название сети Wi-Fi</p>
        <p class="commentary">Ввести пароль к сети Wi-Fi (если необходимо)</p>
        <h3>Синхронизация системных часов</h3>
        <div class="code">
          <pre># timedatectl set-ntp true</pre>
        </div>
        <h3>Разбиение дисков на разделы</h3>
        <p class="commentary">Посмотреть какие диски есть</p>
        <div class="code">
          <pre># fdisk -l</pre>
        </div>
        <p class="commentary">Запустить <i>fdisk</i> для создания разделов</p>
        <div class="code">
          <pre># fdisk /dev/sda</pre>
        </div>
        <p class="commentary">Создать MBR таблицу</p>
        <div class="code">
          <pre>o</pre>
        </div>
        <p class="commentary">Создание раздела <b>/boot</b></p>
        <div class="code">
          <pre>создать новый раздел - n
тип раздела (primary (основной) или extented (расширенный)) - p
выбор номера диска - 1
первый сектор раздела - нажать <i>enter</i>
последний сектор раздела (определяется +объём_памятиM(МБ)/G(ГБ)) - +500M</pre>
        </div>
        <p class="commentary">Создание <b>корневого раздела</b></p>
        <div class="code">
          <pre>создать новый раздел - n
тип раздела (primary (основной) или extented (расширенный)) - p
выбор номера диска - 2
первый сектор раздела - нажать <i>enter</i>
последний сектор раздела (определяется +объём_памятиM(МБ)/G(ГБ)) - +20G</pre>
        </div>
        <p class="commentary">Создание <b>раздела подкачки (swap)</b></p>
        <div class="code">
          <pre>создать новый раздел - n
тип раздела (primary (основной) или extented (расширенный)) - p
выбор номера диска - 3
первый сектор раздела - нажать <i>enter</i>
последний сектор раздела (определяется +объём_памятиM(МБ)/G(ГБ)) - +2G</pre>
        </div>
        <p class="commentary">Создание раздела <b>/home</b></p>
        <div class="code">
          <pre>создать новый раздел - n
тип раздела (primary (основной) или extented (расширенный)) - p
первый сектор раздела - нажать <i>enter</i>
последний сектор раздела - нажать <i>enter</i> (будет выделено всё оставшееся место)</pre>
        </div>
        <p class="commentary">Сделать раздел <b>/boot</b> загрузочным</p>
        <div class="code">
          <pre>запустить определение загрузочного раздела - a
выбрать номер диска - 1</pre>
        </div>
        <p class="commentary">Записать изменения</p>
        <div class="code">
          <pre>w</pre>
        </div>
        <p class="commentary">Проверить разметку диска</p>
        <div class="code">
          <pre># fdisk -l</pre>
        </div>
        <p class="commentary">Пример разметки диска объёмом 50 ГБ</p>
        <img class="fdisk" src="https://i.imgur.com/VJGKU9m.png">
        <h3>Форматирование разделов</h3>
        <div class="code">
          <pre># mkfs.ext2 /dev/sda1 -L boot</pre>
        </div>
        <div class="code">
          <pre># mkfs.ext4 /dev/sda2 -L root</pre>
        </div>
        <div class="code">
          <pre># mkswap /dev/sda3 -L swap</pre>
        </div>
        <div class="code">
          <pre># mkfs.ext4 /dev/sda4 -L home</pre>
        </div>
        <h3>Монтирование разделов</h3>
        <p class="commentary">Смонтировать файловую систему корневого каталога</p>
        <div class="code">
          <pre># mount /dev/sda2 /mnt</pre>
        </div>
        <p class="commentary">Создать директории <b>boot</b> и <b>home</b> в <b>/mnt</b></p>
        <div class="code">
          <pre># mkdir /mnt/{boot,home}</pre>
        </div>
        <p class="commentary">Смонтировать <b>boot</b></p>
        <div class="code">
          <pre># mount /dev/sda1 /mnt/boot</pre>
        </div>
        <p class="commentary">Смонтировать <b>swap</b></p>
        <div class="code">
          <pre># swapon /dev/sda3</pre>
        </div>
        <p class="commentary">Смонтировать <b>home</b></p>
        <div class="code_end">
          <pre># mount /dev/sda4 /mnt/home</pre>
        </div>
      </div>
    </details>
    <details>
      <summary><b>3. Установка</b></summary>
      <div class="in2">
        <h3>Выбор зеркал</h3>
        <p class="commentary">Настроить зеркала. Поставить зеркало Яндекса выше всех остальных.</p>
        <div class="code">
          <pre># nano /etc/pacman.d/mirrorlist</pre>
        </div>
        <div class="code_part">
          <pre>Server = https://mirror.yandex.ru/archlinux/$repo/os/$arch</pre>
        </div>
        <h3>Установка основных пакетов</h3>
        <p class="commentary">Вместо обычного ядра Linux (<b>linux</b>) можно установить LTS (<b>linux-lts</b>) или Zen ядро (<b>linux-zen</b>)</p>
        <div class="code">
          <pre># pacstrap /mnt base base-devel linux linux-firmware nano dhcpcd netctl man-db man-pages</pre>
        </div>
        <h3>Настройка системы</h3>
        <p class="commentary">Сгенерировать файл fstab</p>
        <div class="code">
          <pre># genfstab -pU /mnt >> /mnt/etc/fstab</pre>
        </div>
        <p class="commentary">Перейти к корневому каталогу новой системы</p>
        <div class="code">
          <pre># arch-chroot /mnt</pre>
        </div>
        <p class="commentary">Прописать имя компьютера</p>
        <div class="code">
          <pre># nano /etc/hostname</pre>
        </div>
        <p class="commentary">Настроить часовой пояс для Московского времени</p>
        <div class="code">
          <pre># ln -sf /usr/share/zoneinfo/Europe/Moscow /etc/localtime</pre>
        </div>
        <p class="commentary">Настроить локаль. Раскомментировать строки en_US.UTF-8 и ru_RU.UTF-8.</p>
        <div class="code">
          <pre># nano /etc/locale.gen</pre>
        </div>
        <div class="code_part">
          <pre>en_US.UTF-8 UTF-8
ru_RU.UTF-8 UTF-8</pre>
        </div>
        <p class="commentary">Сгенерировать локаль</p>
        <div class="code">
          <pre># locale-gen</pre>
        </div>
        <p class="commentary">Указать язык системы</p>
        <div class="code">
          <pre># nano /etc/locale.conf</pre>
        </div>
        <div class="code_part">
          <pre>LANG=ru_RU.UTF-8</pre>
        </div>
        <p class="commentary">Указать keymap и шрифт</p>
        <div class="code">
          <pre># nano /etc/vconsole.conf</pre>
        </div>
        <div class="code_part">
          <pre>KEYMAP=ru
FONT=cyr-sun16</pre>
        </div>
        <p class="commentary">Создать загрузочный RAM диск для установленного ядра</p>
        <p class="commentary">Для обычного</p>
        <div class="code">
          <pre># mkinitcpio -p linux</pre>
        </div>
        <p class="commentary">Для LTS</p>
        <div class="code">
          <pre># mkinitcpio -p linux-lts</pre>
        </div>
        <p class="commentary">Для Zen</p>
        <div class="code">
          <pre># mkinitcpio -p linux-zen</pre>
        </div>
        <p class="commentary">Изменить пароль суперпользователя</p>
        <div class="code">
          <pre># passwd</pre>
        </div>
        <p class="commentary">Обновить базы данных пакетов</p>
        <div class="code">
          <pre># pacman -Syy</pre>
        </div>
        <p class="commentary">Установить GRUB</p>
        <div class="code">
          <pre># pacman -S grub</pre>
        </div>
        <p class="commentary">Если будет несколько ОС, то нужно установить нижеуказанные пакеты</p>
        <div class="code">
          <pre># pacman -S os-prober mtools fuse3</pre>
        </div>
        <p class="commentary">Установить программу для Wi-Fi (если необходимо)</p>
        <div class="code">
          <pre># pacman -S dialog wpa_supplicant</pre>
        </div>
        <p class="commentary">Установить загрузчик</p>
        <div class="code">
          <pre># grub-install /dev/sda</pre>
        </div>
        <p class="commentary">Обновить grub.cfg</p>
        <div class="code">
          <pre># grub-mkconfig -o /boot/grub/grub.cfg</pre>
        </div>
        <p class="commentary">Выйти из окружения chroot</p>
        <div class="code">
          <pre># exit</pre>
        </div>
        <p class="commentary">Размонтировать все разделы</p>
        <div class="code">
          <pre># umount -R /mnt</pre>
        </div>
        <p class="commentary">Перезагрузить систему</p>
        <div class="code_end">
          <pre># reboot</pre>
        </div>
      </div>
    </details>
    <details>
      <summary><b>4. После установки</b></summary>
      <div class="in2">
        <p class="commentary">Войти в систему. Логин - root, пароль - тот, что установили.</p>
        <br>
        <p class="commentary">Подключить проводной интернет</p>
        <div class="code">
          <pre># dhcpcd</pre>
        </div>
        <p class="commentary">Или Wi-Fi</p>
        <div class="code">
          <pre># wifi-menu</pre>
        </div>
        <p class="commentary">Создать нового пользователя. Вместо MYUSERNAME вписать имя пользователя.</p>
        <div class="code">
          <pre># useradd -m -g users -G wheel -s /bin/bash MYUSERNAME</pre>
        </div>
        <p class="commentary">Установить пароль для нового пользователя. Вместо MYUSERNAME вписать имя пользователя.</p>
        <div class="code">
          <pre># passwd MYUSERNAME</pre>
        </div>
        <p class="commentary">Настроить sudo для нового пользователя. Раскомментировать нижеуказанную строку.</p>
        <div class="code">
          <pre># nano /etc/sudoers</pre>
        </div>
        <div class="code_part">
          <pre># Uncomment to allow members of group wheel to execute any command
%wheel ALL=(ALL) ALL</pre>
        </div>
        <p class="commentary">Добавить репозиторий multilib (только для x86_64). Раскомментировать нижеуказанные строки.</p>
        <div class="code">
          <pre># nano /etc/pacman.conf</pre>
        </div>
        <div class="code_part">
          <pre>[multilib]
Include = /etc/pacman.d/mirrorlist</pre>
        </div>
        <p class="commentary">Обновить базы данных пакетов</p>
        <div class="code">
          <pre># pacman -Syy</pre>
        </div>
        <p class="commentary">Установить иксы и драйвера</p>
        <div class="code">
          <pre># pacman -S xorg-server xorg-drivers xorg-xinit</pre>
        </div>
        <p class="commentary">Установить гостевые дополнения VirtualBox для корректной работы системы на виртуальной машине (если устанавливаете на виртуальную машину)</p>
        <div class="code">
          <pre># pacman -S virtualbox-guest-utils</pre>
        </div>
        <p class="commentary">Установить GNOME, GNOME Tweaks и GDM</p>
        <div class="code">
          <pre># pacman -S gnome gnome-tweaks gdm</pre>
        </div>
        <p class="commentary">Если хотите Xfce, то нужно установить это</p>
        <div class="code">
          <pre># pacman -S xfce4 xfce4-goodies lxdm</pre>
        </div>
        <br>
        <p class="commentary"><i>Другие DE</i></p>
        <p class="commentary">LXDE</p>
        <div class="code">
          <pre># pacman -S lxde</pre>
        </div>
        <p class="commentary">Cinnamon</p>
        <div class="code">
          <pre># pacman -S cinnamon gdm</pre>
        </div>
        <p class="commentary">MATE</p>
        <div class="code">
          <pre># pacman -S mate mate-extra gdm</pre>
        </div>
        <p class="commentary">i3</p>
        <div class="code">
          <pre># pacman -S i3-wm i3status i3blocks i3lock dmenu picom xfce4-terminal vim ranger feh cmus mpv scrot lxdm lxappearance ttf-font-awesome terminus-font</pre>
        </div>
        <p class="commentary">LXQt</p>
        <div class="code">
          <pre># pacman -S lxqt lxdm</pre>
        </div>
        <p class="commentary">KDE Plasma</p>
        <div class="code">
          <pre># pacman -S plasma gdm</pre>
        </div>
        <p class="commentary">Pantheon</p>
        <div class="code">
          <pre># pacman -S pantheon gdm</pre>
        </div>
        <p class="commentary">Budgie</p>
        <div class="code">
          <pre># pacman -S budgie gdm</pre>
        </div>
        <br>
        <p class="commentary">Установить шрифты</p>
        <div class="code">
          <pre># pacman -S ttf-dejavu ttf-liberation</pre>
        </div>
        <p class="commentary">Установить менеджер сети</p>
        <div class="code">
          <pre># pacman -S networkmanager network-manager-applet ppp</pre>
        </div>
        <p class="commentary">Включить автозагрузку менеджера входа и интернет (для GNOME/Cinnamon/MATE/KDE Plasma/Pantheon/Budgie)</p>
        <div class="code">
          <pre># systemctl enable gdm NetworkManager</pre>
        </div>
        <p class="commentary">Включить автозагрузку менеджера входа и интернет (для Xfce/LXDE/i3/LXQt)</p>
        <div class="code">
          <pre># systemctl enable lxdm NetworkManager</pre>
        </div>
        <p class="commentary">Перезагрузить систему</p>
        <div class="code_end">
          <pre># reboot</pre>
        </div>
      </div>
    </details>
    <details>
      <summary><b>5. Дополнительные настройки</b></summary>
      <div class="in2">
        <h3>Установка AUR</h3>
        <p class="commentary">Обновить базы данных пакетов</p>
        <div class="code">
          <pre>$ sudo pacman -Syy</pre>
        </div>
        <p class="commentary">Если в системе не установлен <b>Git</b>, то нужно его установить</p>
        <div class="code">
          <pre>$ sudo pacman -S git</pre>
        </div>
        <p class="commentary">Установить <b>yay</b></p>
        <div class="code">
          <pre>$ git clone https://aur.archlinux.org/yay.git
$ cd yay
$ makepkg -sir --skippgpcheck
$ cd ..
$ rm -rf yay</pre>
        </div>
        <h3>Установка программ из Pacman</h3>
        <div class="code">
          <pre>$ sudo pacman -S <i>имя_пакета1 имя_пакета2 ...</i></pre>
        </div>
        <h3>Установка программ из AUR</h3>
        <div class="code">
          <pre>$ yay -S <i>имя_пакета1 имя_пакета2 ...</i></pre>
        </div>
        <h3>Обновление системы</h3>
        <p class="commentary">Обновление всей системы производится одной командой</p>
        <div class="code">
          <pre>$ yay -Syu</pre>
        </div>
        <p class="commentary">Обновление программ из Pacman</p>
        <div class="code">
          <pre>$ sudo pacman -Syyu</pre>
        </div>
        <p class="commentary">Обновление программ из AUR</p>
        <div class="code_end">
          <pre>$ yay -Sua</pre>
        </div>
        <br>
        <p class="commentary">Рекомендуемые настройки системы: <a href="https://zurg3.github.io/arch-linux-info/arch_settings" target="_blank">https://zurg3.github.io/arch-linux-info/arch_settings</a></p>
      </div>
    </details>
    <hr>
    <p class="commentary_end" align="center"><i>Эта инструкция по установке Arch Linux сделана на основе <a href="https://wiki.archlinux.org/title/Installation_guide_(Русский)" target="_blank">инструкции по установке из ArchWiki</a> и <a href="https://docs.google.com/document/d/1IsTwkhYvYde9y3zTD1EscqockzdtdUYcItnAglYfZdU/view" target="_blank">чек листа по установке и настройке Arch Linux Xfce от Алексея Бойко</a></i></p>
  </body>
</html>
